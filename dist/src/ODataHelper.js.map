{"version":3,"sources":["src/ODataHelper.ts"],"names":[],"mappings":"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","file":"src/ODataHelper.js","sourcesContent":["/**\r\n * Module with helper methods related to OData requests.\r\n */\r\nexport module ODataHelper {\r\n    //TODO: ezeket vhova kivezetni\r\n    const ODATA_PARAMS = ['select', 'expand', 'orderby', 'top', 'skip', 'filter', 'format', 'inlinecount'];\r\n    export const DATA_ROOT = 'OData.svc';\r\n\r\n    /**\r\n     * Method to build proper parameter string to OData requests based on the given option Object.\r\n     *\r\n     * Checks whether a given parameter is standard OData param or not and based on this information this params get the '$' sign.\r\n     *\r\n     * If there's no select param given, or it is empty 'Id' is the default, so only this field will be on the content in the JSON result. To get all the field values, without selection, set it to 'all', but please avoid this if it's possible.\r\n     * @param options {IODataOptions} Represents an ODataOptions obejct based through the IODataOptions interface. Holds the possible url parameters as properties.\r\n     * @returns {string} String with the url params in the correct format e.g. '$select=DisplayName,Index'&$top=2&metadata=no'.\r\n     */\r\n    export function buildUrlParamString(options?): string {\r\n        if (typeof options === 'undefined') {\r\n            return '';\r\n        }\r\n        let params: string = '?';\r\n        let currentCount = 0;\r\n        if (typeof options.select !== 'undefined') {\r\n            if (typeof options.select === 'string' && options.select !== 'all') {\r\n                let value = options.select;\r\n                options.select = [value, 'Id', 'Type'];\r\n            }\r\n            else if (options.select !== 'all') {\r\n                options.select = [...options.select, 'Id', 'Type']\r\n            }\r\n            else {\r\n                delete options['select'];\r\n            }\r\n        }\r\n        else {\r\n            options.select = ['Id', 'Type'];\r\n        }\r\n        for (let key in options) {\r\n\r\n            if (typeof options[key] !== 'undefined') {\r\n                if (ODATA_PARAMS.indexOf(key) > -1) {\r\n                    params += `$${key}=`;\r\n                    if (typeof options[key] === 'string') {\r\n                        params += options[key];\r\n                    }\r\n                    else if (typeof options[key] !== 'undefined') {\r\n                        for (let x = 0; x < options[key].length; x++) {\r\n                            if (typeof options[key] !== 'undefined') {\r\n                                params += `${options[key][x]}`;\r\n                                if (x < options[key].length - 1) {\r\n                                    params += `,`;\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                }\r\n                else {\r\n                    if (typeof options[key] !== 'undefined') {\r\n                        params += `${key}=${options[key]}`;\r\n                    }\r\n                }\r\n                params += `&`;\r\n            }\r\n        }\r\n        if (typeof options.metadata === 'undefined') {\r\n            params += 'metadata=no&';\r\n        }\r\n\r\n        return params.slice(0, params.length - 1);\r\n    }\r\n    /**\r\n     * Method to help building body part of a POST OData request.\r\n     *\r\n     * Converts the given JSON to string and wraps it into a 'models' array.\r\n     * @param options\r\n     * @returns {string} Models array with the given options in string format e.g. 'models=[\"{ '__ContentType':'EventList' , 'DisplayName': 'Calendar', 'Index': 2 }\"]'.\r\n     */\r\n    export function buildRequestBody(options) {\r\n        let stringifiedOptions = JSON.stringify(options);\r\n        return `models=[${stringifiedOptions}]`;\r\n    }\r\n    /**\r\n     * Method that gets the URL that refers to a single item in the Sense/Net Content Repository\r\n     * @param path {string} Path that you want to format.\r\n     * @returns {string} Path in entity format e.g. /workspaces('project') from /workspaces/project\r\n     */\r\n    export function getContentURLbyPath(path: string): string {\r\n        if (typeof path === 'undefined' || path.indexOf('/') < 0 || path.length <= 1) {\r\n            throw new Error('This is not a valid path.');\r\n        }\r\n        if (isItemPath(path))\r\n            return path;\r\n\r\n        let lastSlashPosition = path.lastIndexOf('/');\r\n        let name = path.substring(lastSlashPosition + 1);\r\n        let parentPath = path.substring(0, lastSlashPosition);\r\n\r\n        return `${parentPath}('${name}')`;\r\n    }\r\n    /**\r\n     * Method that gets the URL that refers to a single item in the Sense/Net Content Repository by its Id\r\n     * @param id {number} Id of the Content.\r\n     * @returns {string} e.g. /content(123)\r\n     */\r\n    export function getContentUrlbyId(id: number): string {\r\n        return `/content(${id})`;\r\n    }\r\n    /**\r\n     * Method that tells if a path is an item path.\r\n     * @param path {string} Path that you want to test.\r\n     * @returns {boolean} Returns if the given path is a path of a Content or not.\r\n     */\r\n    export function isItemPath(path: string): boolean {\r\n        return path.indexOf(\"('\") >= 0 && path.indexOf(\"')\") === path.length - 2;\r\n    }\r\n}"],"sourceRoot":"/source/"}